!!!
%html
  %head
    = render :partial => 'shared/javascripts'
    = yield(:javascripts)
    = stylesheet_link_tag 'application.css'
    = title_tag 'SalesFlip'
    = description_tag 'An unobtrusive, slim CRM built with Mongoid and RightJS'
    = keywords_tag 'SalesFlip salesflip CRM unobtrusive mongoid rightjs mongoDB'
    %meta{ :content => "text/html; charset=utf-8", "http-equiv" => "Content-Type" }
  = body do
    #header
      .pad
        %h1
          = link_to root_path do
            %strong.logo SalesFlip
        = render :partial => 'layouts/nav' if current_user
    #content
      .pad
        - if flash[:notice]
          #flashes
            #flash.notice= flash[:notice]
        - if flash[:error]
          #flashes
            #flash.error= flash[:error]
        #main{ :class => @main_class }
          .pad= yield
        #sidebar
          - if user_signed_in? && !action_is('new', 'create', 'update', 'edit', 'convert')
            #search
              = render :partial => "searches/form"
          = raw yield(:sidebar)
          - if action_is('index')
            #recent_items.box.ice
              %h3= t(:recent_items)
              %ul.plain
                - current_user.recent_items.each do |item|
                  %li
                    %span== #{item.class.to_s}:
                    - if item.instance_of?(Comment)
                      = 'on ' + link_to(item.commentable.full_name, item.commentable)
                    - elsif item.respond_to?(:deleted_at)
                      = item.deleted_at.blank? ? link_to(item.name, item) : item.name
                    - else
                      = link_to(item.name, item)
      .clear
